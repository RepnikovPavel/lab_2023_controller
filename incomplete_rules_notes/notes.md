

# жадный алгоритм подбора правил  

Пусть заданы $N$ ограничений   
Задать дополнительно $P_{N+1}(x|k),P_{N+1}(y|k),P_{N+2}(x|k),\dots,P_{N+n}(y|k)$ ограничения, 
причем $P_{i}(y|k),i=\overline{N+1,N+n}$ - равномерное распределение.  
Пока $i=\overline{N+1,N+n}$
1. выбрать $j$-е носители среди $supp(P_{i}(x|i))\times supp(P_{i}(y|i))$ таких, что $IOU(supp(P_{i}(x|i))\times supp(P_{i}(y|i)),supp(P_{l}(x|l))\times supp(P_{l}(y|l))) > \alpha $  
2. варьировать $P(x,y,i)$ и $P(x,y,j)$ пока не будет достигнут локальный минимум критерия качества.
3. занести $P(x,y,i)$ в список распределений, которые больше менять нельзя.

Комментарии: 
1. пункт 1 в алгоритме означает, что мы варьируем не только $i$-е распределение, но и его соседей в смысле достаточного наложения друг на друга в смысле $Jaccard \: Index$  

до фильтра по $IOU$ кандидатов на варьирование слишком много. Вероятность выпадения нужной комбинации управляющих действия слишком мала.
![Alt text](image-12.png) 

после фильтра по $IOU$ кандидатов сильно меньше. вероятность примерно равна $\frac{1}{\text{число кандидатов}^{2}}$   

![Alt text](image-13.png)

2. в картинках, приведенных ниже, критерий качества на каждой итерации не доводился до минимума для экономии времени.



# промежуточные результаты    
Все промежуточные результаты см. в файле steps.html

![Alt text](image-8.png)  
![Alt text](image-9.png)

# конец работы алгоритма Критерий 1:
Критерий качества: направление в плоскости $(\theta,\omega)$ в последней точке симуляции должно быть направлено к центру  

![Alt text](image-10.png)
![Alt text](image-11.png)

# Критерий 2:  
Можно использовать более простой критерий качества: точка в плоскости $(\theta,\omega)$ в последней точке симуляции должно быть наиболее близка к центру. 
Картинку не прикрепил, т.к. пересчитывать долго. На словах можно описать так. Точки стремятся к центру, но траектории ломаные.